\documentclass[main.tex]{subfiles}
\begin{document}

\section{Dynamics of inflation}

\marginpar{Monday\\ 2020-10-19, \\ compiled \\ \today}

Our action will be in the form 
%
\begin{align}
S = S_{EH} + S_\varphi + S _{\text{matter}}
\,,
\end{align}
%
where \(S_{EH}\) is the Einstein-Hilbert action for the metric, \(S_\varphi \) is the action for the field \(\varphi \), while ``matter'' encompasses all the other fields:
%
\begin{align}
S = \frac{1}{16 \pi G} \int \dd[4]{x} \sqrt{-g} R 
+ \int \dd[4]{x} \sqrt{-g} \mathscr{L}_\varphi [\varphi , g_{\mu \nu }]
+ S _{\text{matter}}
\,.
\end{align}

We are using the invariant volume element \(\dd[4]{x} \sqrt{-g}\), which represents the physical 4-volume regardless of the coordinates.

The simplest possibility for the Lagrangian of a scalar field which is able to drive inflation reads: 
%
\begin{align}
\mathscr{L}_{\varphi } = -\frac{1}{2} g^{\mu \nu } \nabla_{\mu } \varphi \nabla_{\nu } \varphi  - V(\varphi )
\,,
\end{align}
%
for a \emph{real} scalar field \(\varphi \).
Also, note that we did not consider any explicit coupling of \(\varphi \) with gravity or other fields: these kinds of terms, which go by the name ``nonminimal coupling'', might look like \(\xi \varphi^2 R\).

These kinds of nonminimal theories represent one of the simplest extensions of GR: they are \emph{scalar-tensor} theories, and in them the field \(\varphi \) as well as \(g_{\mu \nu }\) can mediate gravity. 
One of the theories which currently fits the cosmological data best is of this kind. 

What could we put in the potential? The mass is given by \(m_\varphi^2 = \pdv*[2]{V}{\varphi }\), so a simple mass term would look like \(m^2 \varphi^2 / 2\), but we could also have quartic terms like \(\lambda \varphi^{4} / 4\): these are self-interaction terms. 

The other fields will typically be negligible during inflation since their energy density is quickly ``redshifted away''. 
Sometimes some of them are non-negligible: this happens if they are coupled to the scalar field, and we must consider them; we typically do so in an ``effective'' way, by inserting them into the potential \(V(\varphi )\). 

We can associate an energy-momentum tensor to the scalar field: in general, it is defined by 
%
\begin{align}
T_{\mu \nu }^{(\varphi )} = - \frac{2}{\sqrt{-g}} \fdv{S_{\varphi }}{g^{\mu \nu }}
\,.
\end{align}

This comes from the way we write the Einstein equations from a variational principle. 
For our scalar field, integrating by parts inside the action, we find 
%
\begin{align}
T_{\mu \nu } = \frac{2}{\sqrt{-g}} \qty[
    -\pdv{(\sqrt{-g} \mathscr{L}_\varphi )}{g^{\mu \nu }}
    +
    \partial_{\alpha }
    \pdv{(\sqrt{-g} \mathscr{L}_\varphi )}{\tensor{g}{^{\mu \nu }_{,\alpha }}} 
    + \text{higher order terms}
]
\,.
\end{align}

% \todo[inline]{Is the derivative covariant?}

The reason for the alternating signs is that we must integrate by parts in order to get the expression in this form. 
We then get 
%
\begin{align}
T^{(\varphi )}_{\mu \nu } = 
- 2 \frac{\partial\mathscr{L}_\varphi }{\partial g^{\mu \nu }} + \frac{2}{\sqrt{-g}} \mathscr{L}_\varphi \pdv{\sqrt{-g}}{g^{\mu \nu }}
\,,
\end{align}
%
since there is no dependence on the derivative(s) of the metric in our case.
\begin{claim}
The following expression holds:
% We need the explicit expression 
%
\begin{align}
\pdv{\sqrt{-g}}{g^{\mu \nu }} = - \frac{1}{2} \sqrt{-g} g_{\mu \nu }
\,.
\end{align}
\end{claim}

\begin{proof}
The expression can be derived from the general matrix relation  \(\Tr \log M = \log \det M\), applied taking \(M = g^{\mu \nu }\): abusing the notation a bit with the indices
%
\begin{align}
\Tr \log g^{\mu \nu } = \log \det g^{\mu \nu } 
\,,
\end{align}
%
which we then differentiate, using \(g = \det g_{\mu \nu }\), the fact that the trace is linear, and the matrix logarithmic derivative expression \(\delta \log M = M^{-1} \delta M\):\footnote{Which holds as long as \(M^{-1}\) and \(\delta M\) commute. }
%
\begin{align}
\Tr \qty(M^{-1} \delta M) &= \frac{ \delta \det g^{\mu \nu }}{\det g^{\mu \nu }} = \frac{ \delta (1/g)}{ 1/g}  \\
\Tr \qty(g_{\mu \nu } \delta g^{\nu \rho }) &= - \frac{ \delta g}{g}  \\
g_{\mu \nu } \delta g^{\mu \nu } &= - \frac{ \delta g}{g}
\marginnote{Symmetry of the metric's indices.}
\,.
\end{align}

Let us now consider a variation of \(\sqrt{-g}\): 
%
\begin{align}
\delta \sqrt{-g} &= - \frac{1}{2} \frac{1}{\sqrt{-g}} \delta g = + \frac{1}{2} \underbrace{\frac{1}{\sqrt{-g}} g}_{-\sqrt{-g}} g_{\mu \nu } \delta g^{\mu \nu }   \\
\fdv{\sqrt{-g}}{g^{\mu \nu }} &= - \frac{\sqrt{-g}}{2} g_{\mu \nu }
\,.
\end{align}

This is the final result. We used the fact that \(g / \sqrt{-g} = - \sqrt{-g}\), which is the correct solution of \((g / \sqrt{-g})^2 = -g\) because we know  \(g\) to be negative.
\end{proof}

This yields 
%
\begin{align}
T^{(\varphi )}_{\mu \nu }  &= 
- 2 \pdv{\mathscr{L}_\varphi }{g^{\mu \nu }} + \mathscr{L}_\varphi g_{\mu \nu }
\\
&= \partial_{\mu } \varphi \partial_{\nu } \varphi 
+ g_{\mu \nu } \qty[- \frac{1}{2} g^{\alpha \beta } \varphi_{, \alpha } \varphi_{, \beta } - V(\varphi )] 
\,.
\end{align}

\begin{claim}
In general, this is a perfect fluid stress energy tensor, with 
%
\begin{align}
P &= -\frac{1}{2} g^{\alpha \beta } \varphi_{, \alpha } \varphi_{, \beta } - V(\varphi )  \\
\rho &= - \frac{1}{2} g^{\alpha \beta } \varphi_{, \alpha } \varphi_{, \beta }  + V(\varphi ) \\
u_\mu &= \frac{\partial_{\mu}\varphi}{\abs{\partial \varphi }}  \\
\abs{\partial \varphi} &= \sqrt{- g^{\alpha \beta } \varphi_{, \alpha } \varphi_{, \beta }}
\,.
\end{align}
\end{claim}

\begin{proof}
As the parameters are given, we only need to verify that the expressions are equivalent: 
%
\begin{align}
T_{\mu \nu } &= (\rho + P ) u_\mu u_\nu + P g_{\mu \nu }   \\
&= \underbrace{(- g^{\alpha \beta } \varphi_{, \alpha } \varphi_{, \beta } )}_{\abs{\partial \varphi}^2} u_\mu u_\nu + \qty( -\frac{1}{2} g^{\alpha \beta } \varphi_{, \alpha } \varphi_{, \beta } - V(\varphi ) ) g_{\mu \nu }  \\
&= \varphi_{, \mu } \varphi_{, \nu } - \qty(\frac{1}{2} g^{\alpha \beta } \varphi_{, \alpha } \varphi_{, \beta } + V(\varphi )) g_{\mu \nu }
\,.
\end{align}
\end{proof}

We start by considering a homogeneous and isotropic case, and then perturb it. This is done by splitting the field into the average classical background motion of \(\varphi \), called \(\varphi_0 \) 
%
\begin{align}
\varphi = \varphi (\vec{x}, t) = \varphi_0 (t) + \delta \varphi (\vec{x}, t)
\,,
\end{align}
%
where \(\varphi_0 \) will be the VEV of the field: \(\varphi_0 = \bra{0} \varphi (\vec{x}, t) \ket{0}\), while \(\delta \varphi \) encompasses the quantum fluctuations. 

Are we allowed to do this kind of split?
Formally yes, but we need to guarantee that the perturbations are indeed small compared to the classical trajectory: \(\expval{ \delta \varphi^2} \ll \varphi_0^2 (t)\).
We consider the variance since it is the first nonzero moment, as \(\expval{ \delta \varphi }= 0\). 

This will not always be the case, sometimes the fluctuation will be dominating; however usually for an inflationary model to work we expect that the condition is satisfied.
The fluctuations are what generates the density fluctuations which create the anisotropies in the CMB photons: we know that the size of these anisotropies is of the order of one part in \num{e5}, so we can give a qualitative argument for the perturbations of the scalar field to be relatively small compared to the mean value. 

If we do the explicit computation for the energy-momentum tensor of the classical background \(\varphi_0\) only we find:
%
\begin{align} \label{eq:energy-momentum-scalar-field}
T^{0}_{0} &= - \qty( \frac{1}{2} \dot{\varphi}_0(t)^2 + V(\varphi_0 )) = - \rho_\varphi (t)   \\
T^{i}_{j} &= \qty( \frac{1}{2} \dot{\varphi}_0^2 (t) - V(\varphi_0 )) \delta^{i}_{j} = P_\varphi \delta^{i}_{j}
\,.
\end{align}

This is a perfect-fluid energy-momentum tensor. 
If we are in a regime for which 
%
\begin{align}
\frac{1}{2} \dot{\varphi}_0^2 (t) \ll V(\varphi_0 )
\,
\end{align}
%
when we have \(P_\varphi \approx - \rho _\varphi \): this is a \emph{quasi De Sitter} expansion, with \(w_\varphi \approx -1\). 

This is achieved if the potential for the scalar field is ``flat enough'': then, we reach a \emph{friction-domination} regime, which is commonly called \emph{slow-roll} inflation. 

\todo[inline]{Insert picture of flat potential}

If \(V(\varphi )\) is approximately a constant, then it mimics a cosmological constant. 
Inflation is driven by the vacuum energy density associated with the scalar field. 

Let us look at the slow-roll dynamics in more detail. 
What is the equation of motion for this (quantum!) scalar field?

\begin{claim}

It is just the Klein-Gordon equation, which can be derived by functional differentiation of the action with respect to \(\varphi \): 
%
\begin{align}
\square \varphi = \pdv{V}{\varphi }
\,.
\end{align}
\end{claim}

The Dalambertian operator here reads 
%
\begin{align}
\square \varphi = \frac{1}{\sqrt{-g}} \qty(g^{\mu \nu } \sqrt{-g} \varphi_{, \mu })_{, \nu }
\,.
\end{align}

\begin{proof}
Functionally differentiating the action yields
%
\begin{align}
\fdv{S}{\varphi } &= \fdv{}{\varphi } \int \dd[4]{x} \sqrt{-g} \qty(- \frac{1}{2} g^{\alpha \beta } \varphi_{, \alpha } \varphi_{, \beta } - V(\varphi ))  \\
&= \fdv{}{\varphi } \int \dd[4]{x} \qty(\qty( \frac{\sqrt{-g}}{2} g^{\alpha \beta } \varphi_{, \alpha })_{,\beta } \varphi  - V(\varphi ) \sqrt{-g})  \\
&= \sqrt{-g} \qty( \frac{1}{\sqrt{-g}} \partial_{\beta } \qty( \sqrt{-g} g^{\alpha \beta } \partial_{\alpha } \varphi ) - \pdv{V}{\varphi }) = 0
\,.
\end{align}


\end{proof}

Let us see what this reduces to in a \textbf{flat FLRW} metric: then \(\sqrt{-g} = a^3\), so 
%
\begin{align}
\square \varphi = \frac{1}{a^3} \qty(g^{00} a^3\varphi_{, 0})_{, 0}
+ \frac{1}{a^3} \qty(g^{ii} a^3\varphi_{, i})_{, i} &= \pdv{V}{\varphi }  \\
- \ddot{\varphi} - \dot{\varphi} 3\frac{\dot{a}}{a}
+ \frac{\nabla^2}{a^2} \varphi 
&= \pdv{V}{ \varphi }  \\
\ddot{\varphi} + 3 H \dot{\varphi} - \frac{\nabla^2 \varphi }{a^2} &= - \pdv{V}{\varphi }
\,.
\end{align}

The term \(3 H \dot{\varphi}\) is a kind of \emph{friction} term: the propagation of the field is ``held back'' by the expansion. 
If we consider the background field, it will be constant in space, so it will evolve as 
%
\begin{align} \label{eq:klein-gordon-scalar-field-flat-FLRW}
\ddot{\varphi}_0 + 3 H \dot{\varphi}_0 = - \pdv{V}{\varphi_0 }
\,.
\end{align}

We then must solve this equation combined with the Friedmann equation 
%
\begin{align}
H^2 = \frac{8 \pi G}{3} \qty(\rho _\varphi + \rho _m + \rho _r) - \frac{k}{a^2}
\,.
\end{align}

The matter and radiation densities scale like \(a^{-3}\) for \(\rho _m\), \(a^{-4}\) for \(\rho _r\); in this early phase the scalar field will dominate the dynamics, so the equation will simplify to 
%
\begin{align} \label{eq:hubble-rate-scalar-field-flat-FLRW}
H^2 \approx \frac{8 \pi G}{3} V(\varphi_0 )
\,.
\end{align}

Under these slow-roll conditions, we also have \(\ddot{\varphi}_0 \ll 3 H \dot{\varphi}_0\): therefore equation \eqref{eq:klein-gordon-scalar-field-flat-FLRW} simplifies to
%
\begin{align} \label{eq:approx-EOM-scalar-field-flat-FLRW}
3 H \dot{\varphi}_{0} \approx - \pdv{V}{\varphi_0 }
\,.
\end{align}

We also expect that \(V\) and all of its derivatives change very slowly with \(\varphi \). 
This means that in this equation we have \(\pdv{V}{\varphi_0 } \approx \const\), as well as \(H \approx \const\): this is the same equation which is obeyed by a particle under a constant force and friction: it will then reach the asymptotic ``\textbf{terminal velocity}'' and move with a constant \(\dot{\varphi}_0 \). This solution is an attractor. 

We typically write this as \(\dot{\varphi} = - V' (\varphi_0 ) / 3H\), and \(H^2 = \frac{8 \pi G}{3} V(\varphi )\). 

\subsection{Slow-roll parameters}

These are parameters we need to quantify how much the potential indeed looks like we expected. 

The first parameter we define is
%
\begin{align}
\epsilon 
= - \frac{\dot{H}}{H^2} = 
+ 4 \pi G \frac{\dot{\varphi}^2}{H^2} \approx \frac{3}{2} \frac{\dot{\varphi}^2}{V} = \frac{1}{16 \pi G} \qty(\frac{V'}{V})^2
\,,
\end{align}
%
where the manipulations follow from equations \eqref{eq:approx-EOM-scalar-field-flat-FLRW} and \eqref{eq:hubble-rate-scalar-field-flat-FLRW}.

\begin{proof}
Let us show that the manipulations work. We start by differentiating equation \eqref{eq:hubble-rate-scalar-field-flat-FLRW} with respect to time: 
%
\begin{align}
2 H \dot{H} &= \frac{8 \pi G}{3} \pdv{V}{\varphi } \dot{\varphi}  \\
\dot{H} &= 4 \pi G \underbrace{\frac{V'}{3 H}}_{- \dot{\varphi}} \dot{\varphi} = - 4 \pi G \dot{\varphi}^2 \label{eq:hdot-phidot-relation}
\,,
\end{align}
%
which, divided by \(H^2\), yields the first equality. 

The second equality comes from the substitution of the expression for \(H^2\) from equation \eqref{eq:hubble-rate-scalar-field-flat-FLRW}. 
Then, we can square the relation \(\dot{\varphi} = - V' / 3 H\) to get 
%
\begin{align}
\dot{\varphi}^2 = \qty(\frac{V'}{3H})^2
\,,
\end{align}
%
which allows us to manipulate 
%
\begin{align}
\frac{3}{2} \frac{\dot{\varphi}^2}{V} &= \frac{3}{2V} \qty(\frac{V'}{3H})^2  \\
&= \frac{3 (V')^2}{2V \frac{8 \pi G}{3} V}  \\
&= \frac{1}{16 \pi G} \qty( \frac{V'}{V})^2
\,.
\end{align}
\end{proof}

\begin{claim}
The relation \(\dot{H} = - 4 \pi G \dot{\varphi}^2\) holds exactly in the case of a single scalar field with the action we have been using so far. 
\end{claim}

\begin{proof}

We start from the Friedmann equation for flat spacetime: 
%
\begin{align}
H^2 &= \frac{8 \pi G}{3} \rho = \frac{8 \pi G}{3} \qty(V(\varphi ) + \frac{1}{2} \dot{\varphi}^2 - \frac{1}{2} \frac{\abs{\nabla\varphi}^2}{a^2} ) 
\,.
\end{align}

Now, we proceed as we did previously, by differentiating everything with respect to time: 
%
\begin{align}
2 H \dot{H} &= \frac{8 \pi G}{3} \qty( V' \dot{\varphi} + \ddot{\varphi} \dot{\varphi} + \frac{1}{a^2} \underbrace{\partial_{i} \varphi \partial_{i} \dot{\varphi}}_{= -\dot{\varphi} \nabla^2 \varphi })  \\
&= \frac{8 \pi G}{3} \dot{\varphi} \qty(- 3 H \dot{\varphi}) \marginnote{Equation of motion.}  \\
\dot{H} &= - 4 \pi G \dot{\varphi}^2
\,,
\end{align}
\end{proof}

\todo[inline]{To fix, something's not right.}

Requiring \(\epsilon \ll 1\) can also be stated as asking that\footnote{A note on the dimensionality: the potential \(V\) has the dimensions of the Lagrangian: in natural units, \SI{}{m^{-4}}. The field \(\varphi \) has the dimensions of an inverse length (a mass), just like the Hubble rate.}
%
\begin{align}
\frac{(V')^2}{16 \pi G V^2} &\ll 1  \\
\frac{(V')^2}{V} &\ll 16 \pi G V = \frac{2}{3} H^2 \\ 
\frac{1}{V} \qty(\pdv{V}{\varphi })^2 &\ll H^2
\,.
\end{align}

So, \(\epsilon \) gives a bound on the first derivative of the potential; the second derivative is controlled by the parameter 
%
\begin{align}
\eta = - \frac{\ddot{\varphi}}{H \dot{\varphi}
}
\,,
\end{align}
%
and we can also define 
%
\begin{align}
\eta _V = \frac{1}{3} \frac{V''}{H^2} = \frac{1}{8 \pi G} \frac{V''}{V}
\,.
\end{align}

Asking that \(\eta _V \ll 1 \) is equivalent to \(V'' \ll H^2\). 

\begin{claim}
These three parameters are related by \(\eta = \eta _V - \epsilon \).
\end{claim}
% We also can ask that \(\abs{\eta _V} < 1\).

\begin{proof}
We start from the relation \(\dot{\varphi} \approx - V' / (3H)\). Differentiating it with respect to time will yield the desired relation: 
%
\begin{align}
\ddot{\varphi} &\approx - \dv{}{t} \qty( \frac{V'}{3H})  \\
&= - \frac{1}{3H} V'' \dot{\varphi} - \frac{V'}{3} \underbrace{\qty(- \frac{\dot{H}}{H^2})}_{\epsilon }  \\
&= - \dot{\varphi} H \frac{V''}{3H^2} - \frac{V'}{3} \epsilon  \\
&= - \dot{\varphi} H \eta _V - \frac{V'}{3} \epsilon  \\
\underbrace{-\frac{\ddot{\varphi}}{H \ddot{\varphi}}}_{\eta } &= \eta _V - \epsilon  
\,.
\end{align}
\end{proof}

\todo[inline]{Is it ok to differentiate this, even though we \emph{know }that \(\ddot{\varphi} = - V' - 3 H \dot{\varphi}\) from the EOM?}

\end{document}
