\documentclass[main.tex]{subfiles}
\begin{document}

\section{Quadrupole approximation}

The procedure to find the quadrupole approximation 
for the GW emitted by a Newtonian system is in the form: 
\begin{enumerate}
    \item determine the density \(\rho (\vec{x}, t)\);
    \item calculate the trace-free inertia tensor \(Q^{ij}(t)\);
    \item calculate the gravitational wave strain \(h_{ij}\). 
\end{enumerate}

\subsection{Two point particles}

In order to model the point-like nature of the particles we can write an expression for the density as a sum of two delta-functions,
whose positions oscillate on the \(x\) axis with an amplitude \(R\):
%
\begin{align}
\rho (\vec{x}, t) = m\delta (\vec{x} - \vec{x}_1(t)) + m\delta (\vec{x} - \vec{x}_2 (t))                                                           \,,
\end{align}
%
where the positions of the particles, \(\vec{x}_1 (t)\) and \(\vec{x}_2 (t)\), will be the solutions to the differential equation \(\vec{F}_{12} = - k (\vec{x}_1 - \vec{x}_2)\). 
If they start out along the \(x\) axis they will remain along it, so the equation will read \(F_{12} = - k (x_1 - x_2 )\), so \(\ddot{x}_1 = - \omega_0 ^2 (x_1 - x_2 )\) and \(\ddot{x}_2 = + \omega_0 ^2 (x_1 - x_2 )\), where \(\omega^2 = k / m\). 

This can be rewritten, by taking the difference of the two, as \(\ddot{\Delta x} = - 2 \omega_0 ^2 \Delta x \), with \(\Delta x = x_1 - x_2 \). 
Therefore, the pulsation of the system is \(\omega = \sqrt{2} \omega_0  \) --- this could also have been calculated as \(\sqrt{k / m_r}\), where \(m_r = m^2/ (m+m) = m/ 2\) is the reduced mass.

So, the position vectors will look like
%
\begin{align}
\vec{x}_1 (t) = R \left[\begin{array}{c}
\cos(\omega t) \\ 
0 \\ 
0
\end{array}\right]
\qquad \text{and} \qquad
\vec{x}_2 (t) = - \vec{x}_1 (t)
\,
\end{align}
%
up to a phase. 

% For simplicity, we will also assume that the radius \(r\) is constant --- this cannot be precisely the case, since there will be some amount of power lost because of the GW emission, but it is a reasonable approximation.

So, the inertia tensor will be given by 
%
\begin{align}
I^{ij} (t) &= \int \rho (\vec{x}, t) x^{i} x^{j} \dd[3]{x}  \\
&= m \sum _{k=1, 2} x_k^{i} x_k^{j}  \\
&= - m R^2 \left[\begin{array}{ccc}
\cos^2 (\omega t) & 0  & 0\\ 
0 & 0 & 0 \\
0 & 0 & 0
\end{array}\right] 
\,.
\end{align}
%
% where we omit the argument of the sines and cosines (which is always \( \)). 
Its trace is equal to its only nonzero component, \(I^{xx}\), therefore its traceless version will look like 
%
\begin{align}
Q^{ij} (t) &= mR^2 \left[\begin{array}{ccc}
- (2/3) \cos^2\omega t & 0 & 0 \\ 
0 & (1/3) \cos^2 \omega t & 0 \\ 
0 & 0 & (1/3) \cos^2 \omega t
\end{array}\right]
\,.
\end{align}
%

The second derivative of this tensor will be given by 
%
\begin{align}
\ddot{Q}^{ij}(t) = \frac{2 mR^2}{3} \omega^2 
\left[\begin{array}{ccc}
2\cos(2 \omega t) & 0  & 0\\ 
0 & - \cos(2 \omega t)  & 0 \\
0 & 0 & - \cos(2 \omega t)
\end{array}\right]
\,.
\end{align}


Now, in order to compute the gravitational wave strain we need the projection tensor \(\Lambda_{ij, kl}\).
If the propagation direction we are interested in is \(\vec{k}\), then the tensor 
%
\begin{align}
P_{ij} = \delta_{ij} - \frac{k_i k_j}{\abs{k}^2} = \delta_{ij} - n_i n_j
\,
\end{align}
%
will project a vector onto the subspace orthogonal to \(\vec{k}\); and the tensor 
%
\begin{align}
\Lambda_{ij, kl} &= P_{ik} P_{jl} - \frac{1}{2} P_{ij} P_{kl}  \\
&= \delta_{ik} \delta_{jl} - n_i n_k \delta_{jl} - \delta_{ik} n_j n_l + \frac{1}{2} n_{i} n_k n_j n_l - \frac{1}{2} \delta_{ij} \delta_{kl} + \frac{1}{2} \delta_{ij} n_k n_l + \frac{1}{2} n_i n_j \delta_{kl} 
\,,
\end{align}
%
will project a rank-2 tensor onto the corresponding subspace. 

Then, the gravitational wave emission will look like: 
%
\begin{align}
h_{ij} (t) &= \frac{2}{r} \frac{G}{c^{4}} \Lambda_{ij, kl} \ddot{Q}_{kl} (t - r/ c)  \\
&= \frac{2}{r} \frac{G}{c^{4}} \frac{2 m R^2 \omega^2}{3} 
\cos(2 \omega (t - r/c)) F_{i j} (\theta , \varphi )
\,,
\end{align}
%
where \(F_{i j}(\theta , \varphi )\) is a tensor depending on the two angles which define the observation-direction unit vector:
%
\begin{align}
\vec{n} = \left[\begin{array}{c}
\sin \theta \cos \varphi  \\ 
\sin \theta \sin \varphi  \\ 
\cos \theta 
\end{array}\right]
\,.
\end{align}

The explicit shape of \(F_{i j}\) depends on the shape of \(\ddot{Q}_{i j}\), the one for this specific case can be calculated analytically with a computer algebra system --- see \href{https://jacopok.github.io/tt_gauge_gw.html}{here}.

However, that specific analytic form is not really interesting --- we want to extract the two actual degrees of freedom of the gravitational wave. 
If we define two vectors \(\vec{m}\) and \(\vec{l}\) which are orthogonal to \(\vec{n}\) and to each other, we will be able to extract the degrees of freedom as \(h_+ (t) = h_{ij} (t) m^i m^i\) and \(h_\times (t) = h_{ij} m^i l^{j}\). 
We can select, for example, the \(\hat{\theta} \) and \(\hat{\varphi}\) unit vectors in a spherical coordinate system in which \(\vec{n} = \hat{r}\) is the radial vector for this purpose. 

The computation yields: 
%
\begin{align}
h_+ (t) &= \frac{2}{r} \frac{G}{c^{4}} m R^2 \omega^2  \qty(\cos^2 \theta \cos^2 \varphi + \cos^2 \varphi  - 1) \cos(2 \omega t) \\
h_\times (t) &= - \frac{2}{r} \frac{G}{c^{4}}  m R^2 \omega^2  \cos \theta \sin( 2 \varphi ) \cos(2 \omega t)
\,.
\end{align}

% The matrix \(h_{ij}\) is then 
% %
% \begin{align}
% h_{ij} &= C \left[\begin{array}{ccc}
% (1 - n_x^2)^2/2  & 
% (n_x^2 - 1) n_x n_y / 2 & 
% (n_x^2 - 1) n_x n_z / 2 \\ 
%  & 
%  \frac{1}{2} n_{y} n_x n_y n_x - \frac{1}{2}  + \frac{1}{2} n_x n_x + \frac{1}{2} n_y n_y 
%   & (n_x^2 + 1) n_y n_z / 2  \\ 
%  &  & 
%  \frac{1}{2} n_{z} n_x n_z n_x - \frac{1}{2} + \frac{1}{2}  n_x n_x + \frac{1}{2} n_z n_z 

% \end{array}\right]
% \,,
% \end{align}
% %
% where 
% %
% \begin{align}
% C = - \frac{2}{r} \frac{G}{c^{4}} \cos( 2 \omega \qty(t - \frac{r}{c}) + \phi )
% \,,
% \end{align}
%

% \subsection{A free-falling particle}

% In this case the motion will be determined by the equation 
% %
% \begin{align}
% F = - \frac{GMm}{r^2} \implies \ddot{r} = - \frac{GM}{r^2}
% \,,
% \end{align}
% %
% for which we need to specify two initial conditions. 

% \subsection{Ellipsoid rotating along its axis}


% The nonzero components of the inertia tensor of an ellipsoid with mass \(m\) and axes \(a\), \(b\), \(c\) are:
% %
% \begin{align}
% I_{11} = \frac{m}{5} (b^2 + c^2) \\
% I_{22} = \frac{m}{5} (a^2 + c^2) \\
% I_{33} = \frac{m}{5} (a^2 + b^2) 
% \,.
% \end{align}

% We give a sketch of the computation, starting from the assumption that \((2/5) m r^2\) is the moment of inertia of a sphere along any axis which passes along the center.
% This means that if we select a Cartesian coordinate system the inertia tensor of the sphere is diagonal, and its components read 
% %
% \begin{align}
% \frac{2}{5} m r^2 = I_{xx } = I_{yy} = I_{zz} = \int_{x^2 + y^2 + z^2 \leq r^2} \rho_s (y^2 + z^2) \dd[3]{x}
% \,,
% \end{align}
% %
% where the (assumed constant) density of the sphere is \(\rho_s = m / V = 3m / 4 \pi r^3\). 
% The integral could be equivalently that of \(x^2 + y^2\) or \(x^2 + z^2\): therefore, each integral in the sphere's volume \(V\) in the form 
% %
% \begin{align}
% \int_{V} \rho x_i^2 \dd[3]{x} = \frac{1}{5} m r^2
% \,
% \end{align}
% %
% must contribute for half of the total.

% With this knowledge, we can compute the moment of inertia along a certain axis, say \(z\), of an ellipsoid with axes \(a\), \(b\) and \(c\): 
% %
% \begin{align}
% I_{zz} &= \int_{(x/a)^2 + (y/b)^2 + (z/c)^2 \leq 1} \rho_e (x^2 + y^2) \dd[3]{x} 
% \,,
% \end{align}
% %
% where now the density of the ellipsoid reads \(\rho _e = m / V = 3m / 4 \pi abc\). 

% We start out by only computing the integral of \(\rho x^2\). We can make a change of coordinates: \(X = x/ a\), \(Y = y / b\) and \(Z = z/c\). The volume element changes as \(\dd[3]{x} = abc \dd[3]{X}\).
 
% In these variables, the integral can be written in terms of the previously found result for a sphere of radius 1, with density \(\rho _1 = 3 m / 4 \pi \):
% %
% \begin{align}
% I_{zz}^{(x^2 \text{ term})} &= \rho_e \int_{X^2 +Y^2+ Z^2 \leq 1} X^2 a^2 abc \dd[3]{X}  \\
% &= \frac{\rho_e}{\rho _1} a^3 bc \int_{X^2 +Y^2+ Z^2 \leq 1} \rho_1 X^2 \dd[3]{X}  \\
% &= \frac{\rho_e}{\rho _1} a^3 bc \frac{m}{5} = \frac{m}{5} \frac{a^3 bc}{abc} = a^2 \frac{m}{5}
% \,,
% \end{align}
% %
% so the full component reads \(I_{zz} = (a^2 + b^2) m/ 5\). 
% The off-diagonal components, instead, vanish by symmetry: integrals in the form \(\int \rho x^{i} x^{j} \dd[3]{x}\) with \(i \neq j\) 

% \subsection{Two particles in circular Newtonian orbit}

% %
% \begin{align}
% \rho (\vec{x}, t) = m_1 \delta (\vec{x} - \vec{x}_1(t)) + m_2 \delta (\vec{x} - \vec{x}_2 (t))                                                                        
% \,,
% \end{align}
% %
% where 
% %
% \begin{align}in
% \vec{x}_1 (t) = r \left[\begin{array}{c}
% \cos(\omega t + \phi ) \\ 
% - \sin(\omega t + \phi ) \\ 
% 0
% \end{array}\right]
% \qquad \text{and} \qquad
% \vec{x}_2 (t) = - \vec{x}_1 (t)
% \,.
% \end{align}

% For simplicity, we will also assume that the radius \(r\) is constant --- this cannot be precisely the case, since there will be some amount of power lost because of the GW emission, but it is a reasonable approximation.

% So, the trace-free inertia tensor will be given by 
% %
% \begin{align}
% Q^{ij} (t) &= \int \rho (\vec{x}, t) \qty( x^{i} x^{j} - \frac{1}{3} \delta^{ij} r^2) \dd[3]{x}  \\
% &= \sum _{k=1, 2} m_k \qty(x_k^{i} x_k^{j} - \frac{1}{3} \delta^{ij} r^2)  \\
% &= 2 m r^2 \left[\begin{array}{cc}
% \cos^2 - 1/3 & - \cos \sin \\ 
% - \cos \sin & \sin^2 - 1/3  
% \end{array}\right] 
% \,,
% \end{align}
% %
% where we write only the upper-left 2x2 submatrix in \(Q^{ij}\), since the other entries are constant, and we omit the argument of the sines and cosines (which is always \(\omega t + \phi \)). 

% The second derivative of this tensor will be given by 
% %
% \begin{align}
% \ddot{Q}^{ij}(t) = 4 m r^2 \omega^2 \left[\begin{array}{cc}
% \sin^2 - \cos^2 & 2 \sin \cos \\ 
% 2 \sin \cos & \cos^2 - \sin^2
% \end{array}\right]
% \,.
% \end{align}

\section{Estimate of GW magnitude}

We want a way to estimate the GW strain, \(h \sim \delta L / L\), by simple considerations about the parameters of the system which is generating the waves. 
In the quadrupole approximation we have \(h \sim (G / c^{4} r) \ddot{I}\), where \(\ddot{I}\) is the typical magnitude of the second derivative of the inertia tensor, while \(r\) is the distance from the system to Earth. 

We know that \(I \sim M R^2\), where \(M\) is the mass of the system while \(R\) is its characteristic radius (for example, a solid sphere has \(I = (2/5)  M R^2 \) --- the \(2/5\) factor is relevant but we will neglect it in this order-of-magnitude estimate).
If \(T\) is the characteristic timescale in which the components of the inertia tensor vary, we can estimate \(\ddot{I}\) as \(\ddot{I} \sim M R^2 / T^2 = M v^2\), where \(v\) is the typical velocity of the various parts of the system. 

With this estimate, we have: 
%
\begin{align}
h \sim \frac{G}{c^{4}r} M v^2 = \frac{GM}{c^2 r} \frac{v^2}{c^2} \sim \frac{R_s}{r} \frac{v^2}{c^2}
\,.
\end{align}

Let us compute this for a few simple examples: 
\begin{enumerate}
    \item a car crash, with \(M \sim \SI{e3}{kg}\), \(v \sim \SI{100}{km/h}\), \(r \sim \SI{10}{m}\);
    \item a supernova explosion, with \(M \sim M_{\odot}\), \(v \sim \num{.2}c\), \(r \sim \SI{2}{kpc}\);
    \item a binary black hole system, with \(M \sim 50M_{\odot}\), \(v \sim \num{.1}c\), \(r \sim \SI{400}{Mpc}\).
\end{enumerate}

We shall use the \texttt{units} system\footnote{\url{https://docs.astropy.org/en/stable/units/index.html}} provided by the python library \texttt{astropy} in order to aid us in this computation: 
we start out with the imports 
\begin{lstlisting}[language=Python]
import astropy.units as u
from astropy.constants import codata2018 as ac
\end{lstlisting}

Now we may define a function yielding the desired estimate: 
\begin{lstlisting}[language=Python]
@u.quantity_input(M='mass', D='length', v='speed')
def estimate_h(M, D, v) -> u.dimensionless_unscaled:
    h = ac.G * M / D / ac.c**2 * (v / ac.c)**2
    # the units system takes care of all the unit conversion for us
    # since we specified that we want the result to be a pure number
    return(h)

print(f'Car crash: {estimate_h(1e3*u.kg, 10*u.m, 100* u.km/u.hr):.0e}')
print(f'Supernova: {estimate_h(1*u.Msun, 2*u.kpc, .2 * ac.c):.0e}')
print(f'Binary BH: {estimate_h(50*u.Msun, 400*u.Mpc, .1 * ac.c):.0e}')
\end{lstlisting}
%
which yields as output
\begin{lstlisting}[language=Python]
Car crash: 6e-40
Supernova: 1e-18
Binary BH: 6e-23
\end{lstlisting}

The \texttt{u.quantity\_input} decorator is not strictly necessary, but this way the function will raise a very clear \texttt{UnitsError} if we try to give it something with the wrong dimensionality as an input.

% The supernova order of magnitude might be severely overestimated with this method: 

\end{document}
