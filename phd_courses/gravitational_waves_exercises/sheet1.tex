\documentclass[main.tex]{subfiles}
\begin{document}

\section{Quadrupole approximation}

The procedure to find the quadrupole approximation 
for the GW emitted by a Newtonian system is in the form: 
\begin{enumerate}
    \item determine the density \(\rho (\vec{x}, t)\);
    \item calculate the trace-free inertia tensor \(Q^{ij}(t)\);
    \item calculate the gravitational wave strain \(h_{ij}\). 
\end{enumerate}

\subsection{Two point particles}

In order to model the point-like nature of the particles we can write an expression for the density as a sum of two delta-functions,
whose positions oscillate on the \(x\) axis with an amplitude \(R\):
%
\begin{align}
\rho (\vec{x}, t) = m\delta (\vec{x} - \vec{x}_1(t)) + m\delta (\vec{x} - \vec{x}_2 (t))                                                           \,,
\end{align}
%
where 
%
\begin{align}
\vec{x}_1 (t) = R \left[\begin{array}{c}
\cos(\omega t + \phi ) \\ 
0 \\ 
0
\end{array}\right]
\qquad \text{and} \qquad
\vec{x}_2 (t) = - \vec{x}_1 (t)
\,.
\end{align}

% For simplicity, we will also assume that the radius \(r\) is constant --- this cannot be precisely the case, since there will be some amount of power lost because of the GW emission, but it is a reasonable approximation.

So, the trace-free inertia tensor will be given by 
%
\begin{align}
Q^{ij} (t) &= \int \rho (\vec{x}, t) \qty( x^{i} x^{j} - \frac{1}{3} \delta^{ij} r^2) \dd[3]{x}  \\
&= m \sum _{k=1, 2} \qty(x_k^{i} x_k^{j} - \frac{1}{3} \delta^{ij}  \abs{x_k}^2)  \\
&= \frac{m}{2} R^2 \left[\begin{array}{ccc}
(2/3)\cos^2 (\omega t + \phi) & 0  & 0\\ 
0 & - (1/3) \cos^2(\omega t + \phi ) & 0 \\
0 & 0 & -(1/3) \cos^2(\omega t + \phi )
\end{array}\right] 
\,.
\end{align}
%
% where we omit the argument of the sines and cosines (which is always \( \)). 

The second derivative of this tensor will be given by 
%
\begin{align}
\ddot{Q}^{ij}(t) = 4 m R^2 \omega^2 
\left[\begin{array}{ccc}
\sin^2 - \cos^2 & 0  & 0\\ 
0 & 0  & 0 \\
0 & 0 & 0
\end{array}\right]
\,.
\end{align}

 

Now, in order to compute the gravitational wave strain we need the projection tensor \(\Lambda_{ij, kl}\).
If the propagation direction we are interested in is \(\vec{k}\), then the tensor 
%
\begin{align}
P_{ij} = \delta_{ij} - \frac{k_i k_j}{\abs{k}^2} = \delta_{ij} - n_i n_j
\,
\end{align}
%
will project a vector onto the subspace orthogonal to \(\vec{k}\); and the tensor 
%
\begin{align}
\Lambda_{ij, kl} &= P_{ik} P_{jl} - \frac{1}{2} P_{ij} P_{kl}  \\
&= \delta_{ik} \delta_{jl} - n_i n_k \delta_{jl} - \delta_{ik} n_j n_l + \frac{1}{2} n_{i} n_k n_j n_l - \frac{1}{2} \delta_{ij} \delta_{kl} + \frac{1}{2} \delta_{ij} n_k n_l + \frac{1}{2} n_i n_j \delta_{kl} 
\,,
\end{align}
%
will project a rank-2 tensor onto the corresponding subspace. 

Then, the gravitational wave emission will look like: 
%
\begin{align}
h_{ij} (t) &= \frac{2}{r} \frac{G}{c^{4}} \Lambda_{ij, kl} \ddot{Q}_{kl} (t - r/ c)  \\
&= \frac{2}{r} \frac{G}{c^{4}} \Lambda_{ij, xx} 
\qty(\sin^2 (\omega t -  \omega r/c + \phi ) - \cos^2 (t - \omega r/c + \phi ))  \\
\begin{split}
&= -\frac{2}{r} \frac{G}{c^{4}} 
\qty(\delta_{ix} \delta_{jx} - n_i n_x \delta_{jx} - \delta_{ix} n_j n_x + \frac{1}{2} n_{i} n_x n_j n_x - \frac{1}{2} \delta_{ij} \delta_{xx} + \frac{1}{2} \delta_{ij} n_x n_x + \frac{1}{2} n_i n_j \delta_{xx} ) \\
&\phantom{=}\ 
\times \cos(2 \omega \qty(r - \frac{r}{c}) + \phi )
\end{split}
\,,
\end{align}
%
which we can express explicitly by writing out 
%
\begin{align}
\vec{n} = \left[\begin{array}{c}
\sin \theta \cos \varphi  \\ 
\sin \theta \sin \varphi  \\ 
\cos \theta 
\end{array}\right]
\,.
\end{align}

% The matrix \(h_{ij}\) is then 
% %
% \begin{align}
% h_{ij} &= C \left[\begin{array}{ccc}
% (1 - n_x^2)^2/2  & 
% (n_x^2 - 1) n_x n_y / 2 & 
% (n_x^2 - 1) n_x n_z / 2 \\ 
%  & 
%  \frac{1}{2} n_{y} n_x n_y n_x - \frac{1}{2}  + \frac{1}{2} n_x n_x + \frac{1}{2} n_y n_y 
%   & (n_x^2 + 1) n_y n_z / 2  \\ 
%  &  & 
%  \frac{1}{2} n_{z} n_x n_z n_x - \frac{1}{2} + \frac{1}{2}  n_x n_x + \frac{1}{2} n_z n_z 

% \end{array}\right]
% \,,
% \end{align}
% %
% where 
% %
% \begin{align}
% C = - \frac{2}{r} \frac{G}{c^{4}} \cos( 2 \omega \qty(t - \frac{r}{c}) + \phi )
% \,,
% \end{align}
%

\subsection{A free-falling particle}



\subsection{Ellipsoid rotating along its axis}

We get 
%
\begin{align}
I_{11} = \frac{m}{5} (b^2 + c^2)
\,,
\end{align}
%


\subsection{Two particles in circular Newtonian orbit}

%
\begin{align}
\rho (\vec{x}, t) = m_1 \delta (\vec{x} - \vec{x}_1(t)) + m_2 \delta (\vec{x} - \vec{x}_2 (t))                                                                        
\,,
\end{align}
%
where 
%
\begin{align}in
\vec{x}_1 (t) = r \left[\begin{array}{c}
\cos(\omega t + \phi ) \\ 
- \sin(\omega t + \phi ) \\ 
0
\end{array}\right]
\qquad \text{and} \qquad
\vec{x}_2 (t) = - \vec{x}_1 (t)
\,.
\end{align}

For simplicity, we will also assume that the radius \(r\) is constant --- this cannot be precisely the case, since there will be some amount of power lost because of the GW emission, but it is a reasonable approximation.

So, the trace-free inertia tensor will be given by 
%
\begin{align}
Q^{ij} (t) &= \int \rho (\vec{x}, t) \qty( x^{i} x^{j} - \frac{1}{3} \delta^{ij} r^2) \dd[3]{x}  \\
&= \sum _{k=1, 2} m_k \qty(x_k^{i} x_k^{j} - \frac{1}{3} \delta^{ij} r^2)  \\
&= 2 m r^2 \left[\begin{array}{cc}
\cos^2 - 1/3 & - \cos \sin \\ 
- \cos \sin & \sin^2 - 1/3  
\end{array}\right] 
\,,
\end{align}
%
where we write only the upper-left 2x2 submatrix in \(Q^{ij}\), since the other entries are constant, and we omit the argument of the sines and cosines (which is always \(\omega t + \phi \)). 

The second derivative of this tensor will be given by 
%
\begin{align}
\ddot{Q}^{ij}(t) = 4 m r^2 \omega^2 \left[\begin{array}{cc}
\sin^2 - \cos^2 & 2 \sin \cos \\ 
2 \sin \cos & \cos^2 - \sin^2
\end{array}\right]
\,.
\end{align}

\section{Estimate of GW magnitude}

We want a way to estimate the GW strain, \(h \sim \delta L / L\), by simple considerations about the parameters of the system which is generating the waves. 
In the quadrupole approximation we have \(h \sim (G / c^{4} r) \ddot{I}\), where \(\ddot{I}\) is the typical magnitude of the second derivative of the inertia tensor, while \(r\) is the distance from the system to Earth. 

We know that \(I \sim M R^2\), where \(M\) is the mass of the system while \(R\) is its characteristic radius (for example, a solid sphere has \(I = (2/5)  M R^2 \) --- the \(2/5\) factor is relevant but we will neglect it in this order-of-magnitude estimate).
If \(T\) is the characteristic timescale in which the components of the inertia tensor vary, we can estimate \(\ddot{I}\) as \(\ddot{I} \sim M R^2 / T^2 = M v^2\), where \(v\) is the typical velocity of the various parts of the system. 

With this estimate, we have: 
%
\begin{align}
h \sim \frac{G}{c^{4}r} M v^2 = \frac{GM}{c^2 r} \frac{v^2}{c^2} \sim \frac{R_s}{r} \frac{v^2}{c^2}
\,.
\end{align}

Let us compute this for a few simple examples: 
\begin{enumerate}
    \item a car crash, with \(M \sim \SI{e3}{kg}\), \(v \sim \SI{100}{km/h}\), \(r \sim \SI{10}{m}\);
    \item a supernova explosion, with \(M \sim M_{\odot}\), \(v \sim \num{.2}c\), \(r \sim \SI{2}{kpc}\);
    \item a binary black hole system, with \(M \sim 50M_{\odot}\), \(v \sim \num{.1}c\), \(r \sim \SI{400}{Mpc}\).
\end{enumerate}

We shall use the \texttt{units} system\footnote{\url{https://docs.astropy.org/en/stable/units/index.html}} provided by the python library \texttt{astropy} in order to aid us in this computation: 
we start out with the imports 
\begin{lstlisting}[language=Python]
import astropy.units as u
from astropy.constants import codata2018 as ac
\end{lstlisting}

Now we may define a function yielding the desired estimate: 
\begin{lstlisting}[language=Python]
@u.quantity_input(M='mass', D='length', v='speed')
def estimate_h(M, D, v) -> u.dimensionless_unscaled:
    h = ac.G * M / D / ac.c**2 * (v / ac.c)**2
    # the units system takes care of all the unit conversion for us
    # since we specified that we want the result to be a pure number
    return(h)

print(f'Car crash: {estimate_h(1e3*u.kg, 10*u.m, 100* u.km/u.hr):.0e}')
print(f'Supernova: {estimate_h(1*u.Msun, 2*u.kpc, .2 * ac.c):.0e}')
print(f'Binary BH: {estimate_h(50*u.Msun, 400*u.Mpc, .1 * ac.c):.0e}')
\end{lstlisting}
%
which yields as output
\begin{lstlisting}[language=Python]
Car crash: 6e-40
Supernova: 1e-18
Binary BH: 6e-23
\end{lstlisting}

The \texttt{u.quantity\_input} decorator is not strictly necessary, but this way the function will raise a very clear \texttt{UnitsError} if we try to give it something with the wrong dimensionality as an input.

% The supernova order of magnitude might be severely overestimated with this method: 

\end{document}
